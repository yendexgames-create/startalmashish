<!doctype html>
<html lang="uz">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Start Almashish WebApp</title>
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <canvas id="snow"></canvas>
    <!-- Tutorial overlay (qadamlar bo'yicha tushuntirish) -->
    <div id="tutorial-overlay" class="tutorial-overlay hidden">
      <div class="tutorial-backdrop"></div>
      <div id="tutorial-highlight" class="tutorial-highlight"></div>
      <div id="tutorial-tooltip" class="tutorial-tooltip">
        <div class="tutorial-text" id="tutorial-text"></div>
        <div class="tutorial-controls">
          <button id="tutorial-skip" class="secondary-btn tutorial-btn">O'tkazib yuborish</button>
          <button id="tutorial-next" class="primary-btn tutorial-btn">Keyingi</button>
        </div>
      </div>
    </div>

    <div id="app">
      <header class="app-header">
        <div class="header-left">â˜°</div>
        <div class="header-center">
          <h1>Xavfsiz Almashish</h1>
          <p class="subtitle">Start almashish uchun qulay mini ilova</p>
        </div>
        <div class="header-right">
          <span class="status-dot"></span>
        </div>
      </header>

      <main class="app-main">
        <section class="view view-active" id="view-home">
          <div class="card" id="home-mini-profile">
            <div class="home-profile-main">
              <div class="home-profile-avatar">ğŸ‘¤</div>
              <div class="home-profile-text">
                <div class="home-profile-username" id="home-username">@username</div>
                <div class="home-profile-slots" id="home-slots-short">Slotlar: -/-</div>
              </div>
            </div>
          </div>

          <div class="card home-grid-card">
            <div class="home-grid">
              <button class="home-tile tile-slots" data-target="view-profile">
                <div class="tile-icon">ğŸ¯</div>
                <div class="tile-title">Slotlar</div>
                <div class="tile-sub" id="tile-slots-info">-/- ochiq</div>
              </button>

              <button class="home-tile tile-exchange" data-target="view-exchange">
                <div class="tile-icon">ğŸ”</div>
                <div class="tile-title">Almashish</div>
                <div class="tile-sub">Boshlash</div>
              </button>

              <button class="home-tile tile-friends" data-target="view-friends">
                <div class="tile-icon">ğŸ¤</div>
                <div class="tile-title">Do'stlar</div>
                <div class="tile-sub" id="tile-friends-info">0 ta</div>
              </button>

              <button class="home-tile tile-referral" data-target="view-friends">
                <div class="tile-icon">ğŸ”—</div>
                <div class="tile-title">Referal</div>
                <div class="tile-sub" id="tile-ref-info">0 / 5</div>
              </button>

              <button class="home-tile tile-stats" data-target="view-profile">
                <div class="tile-icon">ğŸ“Š</div>
                <div class="tile-title">Statistika</div>
                <div class="tile-sub" id="tile-stats-info">0 almashish</div>
              </button>

              <button class="home-tile tile-help" data-target="view-help">
                <div class="tile-icon">âš™ï¸</div>
                <div class="tile-title">Foydalanish</div>
                <div class="tile-sub">Qo'llanma</div>
              </button>
            </div>
          </div>
        </section>

        <section class="view" id="view-exchange">
          <div class="card hero-card">
            <h2>ğŸ” Almashishni topish</h2>
            <p class="hero-text">
              Bu bo'limda siz slotlaringizdan qaysi biri bilan almashishni boshlashni tanlaysiz.
            </p>
            <button id="btn-start-exchange" class="primary-btn">Almashishni topish</button>
          </div>

          <div id="exchange-card" class="exchange-card">
            <div class="exchange-user">
              <div class="exchange-user-avatar" id="exchange-user-avatar">U</div>
              <div class="exchange-user-main">
                <div class="exchange-user-name" id="exchange-user-name">Foydalanuvchi nomi</div>
                <div class="exchange-user-username" id="exchange-user-username">@username</div>
              </div>
            </div>

            <div class="exchange-link-preview">
              <div class="exchange-link-icon" id="exchange-link-icon">ğŸ¤–</div>
              <div class="exchange-link-main">
                <div class="exchange-link-title" id="exchange-link-title">Bot nomi</div>
                <div class="exchange-link-url" id="exchange-link-url">https://t.me/yourbot</div>
                <button type="button" id="exchange-open-bot" class="link-button">Botni koâ€˜rish</button>
              </div>
            </div>

            <p class="exchange-hint">
              "Bor" desangiz, shu almashishga rozilik bildirasiz. "Keyingisi" esa keyingi sherikni koâ€˜rsatish uchun.
            </p>

            <div class="exchange-actions two">
              <button id="exchange-yes" class="primary-btn exchange-btn">Bor</button>
              <button id="exchange-next" class="secondary-btn exchange-btn">Keyingisi</button>
            </div>
            <p id="exchange-status" class="hint-text" style="margin-top: 6px; display: none;"></p>
          </div>

          <div class="card" id="exchange-offers-card" style="margin-top: 10px; display: none;">
            <h2>ğŸ“¨ Takliflar</h2>
            <p class="hint-text" id="exchange-offers-empty">
              Hozircha siz uchun kutilayotgan almashish taklifi yoâ€˜q.
            </p>
            <div id="exchange-offers-list"></div>
          </div>

          <div class="card" id="exchange-sent-card" style="margin-top: 10px; display: none;">
            <h2>ğŸ“¤ Yuborilgan takliflar</h2>
            <p class="hint-text" id="exchange-sent-empty">
              Hozircha siz tomonidan yuborilgan almashish taklifi yoâ€˜q.
            </p>
            <div id="exchange-sent-list"></div>
          </div>

          <div class="card" id="exchange-chat-card" style="margin-top: 10px; display: none;">
            <h2>ğŸ’¬ Chat ochildi</h2>
            <div id="exchange-chat-partner">
              <div id="exchange-chat-name" class="chat-partner-name">Sherik nomi</div>
              <div id="exchange-chat-username" class="chat-partner-username">@username</div>
            </div>
            <p class="hint-text" style="margin-top: 8px;">Quyidagi link orqali sherigingiz botiga oâ€˜ting va chatni boshlang:</p>
            <button id="exchange-chat-link" type="button" class="primary-btn chat-link-btn">https://t.me/yourbot</button>
            <p class="hint-text" style="margin-top: 10px;">
              Chat Telegram ichida davom etadi. Bu yerda almashish tafsilotlari saqlanadi.
            </p>
            <button id="exchange-chat-close" type="button" class="secondary-btn" style="margin-top: 10px;">Chatni yopish</button>
          </div>
        </section>

        <section class="view" id="view-friends">
          <div class="card">
            <h2>ğŸ‘¥ Do'stlar</h2>
            <button id="btn-share-ref" class="secondary-btn">Do'st taklif qilish</button>
            <p class="hint-text">
              Referal orqali do'stlar taklif qilib, qo'shimcha slotlar ochishingiz mumkin.
            </p>
          </div>
        </section>

        <section class="view" id="view-profile">
          <div class="card" id="profile-card">
            <h2>ğŸ‘¤ Profil</h2>
            <div id="profile-content">Yuklanmoqda...</div>
          </div>

          <div class="card" id="slots-card">
            <h3>Slotlar</h3>
            <div id="slots-content">Yuklanmoqda...</div>
          </div>

          <div class="card" id="quick-stats-card">
            <h3>Qisqa statistika</h3>
            <div id="quick-stats-content">Yuklanmoqda...</div>
          </div>

          <div class="card" id="friends-card">
            <h3>Do'stlar ro'yxati</h3>
            <div id="friends-content">Hozircha ma'lumot yo'q.</div>
          </div>
        </section>

        <section class="view" id="view-help">
          <div class="card" id="help-card">
            <h2>â“ Foydalanishni o'rganish</h2>
            <p class="hero-text">
              Quyidagi bosqichma-bosqich ko'rsatmalarga amal qilib, bot va Web ilovadan to'liq
              foydalanishingiz mumkin.
            </p>
            <ul class="help-list">
              <li><strong>1. Boshlash:</strong> Telegramâ€™da botni <code>/start</code> qiling va kerakli ruxsatlarni bering (kanalga aâ€™zolik, telefon raqam).
              </li>
              <li><strong>2. 1-slotni toâ€˜ldirish:</strong> Bot sizdan asosiy bot/link manzilini va qisqacha tavsifni soâ€˜raydi. Shu maâ€™lumotlar almashish paytida ishlatiladi.</li>
              <li><strong>3. Web ilovani ochish:</strong> Bot chatidagi "Open" (ğŸ§© Web ilova) tugmasini bosing va Web ilovani ishga tushiring.</li>
              <li><strong>4. Profil va slotlarni koâ€˜rish:</strong> "Profil" boâ€˜limida oâ€˜zingiz haqidagi maâ€™lumotlar, 1-slot linki va tavsifi, faol slotlar va qisqa statistika koâ€˜rsatiladi.</li>
              <li><strong>5. Almashishni boshlash:</strong> "Bosh sahifa"dan yoki "Almashish" boâ€˜limidan "Almashishni topish" tugmasini bosib, almashish jarayonini boshlang. Bot chatda sizga keyingi qadamlarni koâ€˜rsatadi.</li>
              <li><strong>6. Doâ€˜stlarni taklif qilish:</strong> "Doâ€˜stlar" boâ€˜limida botdagi tegishli menyu orqali referal linkingizni olib, doâ€˜stlarga ulashing. Referallar orqali qoâ€˜shimcha slotlar ochiladi.</li>
              <li><strong>7. Natijalarni kuzatish:</strong> Qisqa statistika boâ€˜limida umumiy almashishlar, referallar va faol slotlar sonini nazorat qilib boring.</li>
            </ul>
          </div>
        </section>
      </main>

      <nav class="bottom-nav">
        <button class="nav-item nav-item-active" data-target="view-home">
          <span class="nav-icon">ğŸ </span>
          <span class="nav-label">Bosh sahifa</span>
        </button>
        <button class="nav-item" data-target="view-exchange">
          <span class="nav-icon">ğŸ”</span>
          <span class="nav-label">Almashish</span>
        </button>
        <button class="nav-item" data-target="view-friends">
          <span class="nav-icon">ğŸ‘¥</span>
          <span class="nav-label">Do'stlar</span>
        </button>
        <button class="nav-item" data-target="view-profile">
          <span class="nav-icon">ğŸ‘¤</span>
          <span class="nav-label">Profil</span>
        </button>
        <button class="nav-item" data-target="view-help">
          <span class="nav-icon">â“</span>
          <span class="nav-label">Foydalanish</span>
        </button>
      </nav>
    </div>

    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="app.js?v=2"></script>
  </body>
</html>
